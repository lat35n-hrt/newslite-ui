# NewsLite UI â€” Cloudflare Workers + KV Prototype

A minimal, server-rendered UI for **NewsLite**, powered by **Cloudflare Workers** and **Workers KV**.
This project fetches pre-generated article summaries (created by a Python backend) from KV and renders them as a clean HTML page on the edge.

The goal is to keep the UI lightweight, serverless, globally distributed, and easy to maintain.

---

## âœ¨ Features

- âš¡ **Cloudflare Workers (TypeScript)** â€” zero infrastructure, global by default
- ðŸ—‚ **Daily article storage in Workers KV** â€” using structured keys like `articles/YYYY-MM-DD`
- ðŸŽ¨ **Zero-JS, server-rendered HTML** (Bootstrap-ready)
- ðŸ”€ **Automatic topic grouping** (`technology`, `climate`, `education`, â€¦)
- ðŸ§ª **Preview / Production KV separation** (Cloudflare best practice)
- ðŸ›  **Fully remote KV access during development** (`remote=true`)

---

## ðŸ“ Project Structure

```
newslite-ui/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ index.ts                              # Worker logic (routing + KV lookup + HTML output)
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ daily_upload_to_kv.py                 # Python uploader for daily JSON â†’ KV
â”œâ”€â”€ data/
â”‚   â””â”€â”€ daily_summary_YYYY-MM-DD.json.example
â”œâ”€â”€ wrangler.example.toml                     # Safe template (no secrets)
â”œâ”€â”€ wrangler.toml                             # NOT committed; developer-specific config
â””â”€â”€ package.json
```

> `wrangler.toml` is intentionally **excluded** from Git history.

---

## Installation

```bash
npm install
```

---

## Cloudflare KV Configuration (Required)

Workers KV requires **two namespaces** per binding:

| Purpose        | wrangler.toml key | Description                      |
|----------------|-------------------|----------------------------------|
| Production KV  | `id`              | Used after `wrangler publish`    |
| Preview KV     | `preview_id`      | Used in `wrangler dev`           |

Example remote-enabled binding:

```toml
[[kv_namespaces]]
binding = "newslite_kv"
id = "SET-IN-YOUR-DASHBOARD"
preview_id = "SET-IN-YOUR-DASHBOARD"
remote = true
```

Copy the example file:

```bash
cp wrangler.example.toml wrangler.toml
```

Then fill in your real KV IDs from Cloudflare Dashboard.

---

##  Running Locally (with Remote KV)

```bash
npx wrangler dev
```

Then open:

```
http://localhost:8787/?date=2025-12-09
```

Because `remote = true`, development mode always reads from preview KV â€” not local Miniflare storage.

---

## Deploying to Cloudflare

```bash
npx wrangler publish
```

After deployment:

- `dev` â†’ uses `preview_id`
- `production` â†’ uses `id`

No further configuration is required.

---

## Writing Daily Article Data to KV

### Example manual upload:

```bash
npx wrangler kv key put articles/2025-12-09 \
  "$(cat data/daily_summary_2025-12-09.json.example)" \
  --binding=newslite_kv --preview --remote
```

### Check stored data:

```bash
npx wrangler kv key get articles/2025-12-09 \
  --binding=newslite_kv --preview --remote
```

---

## Automated Upload (Python)

Daily article JSON files (generated by the NewsLite backend) can be uploaded via:

```bash
PYTHONPATH=. python scripts/daily_upload_to_kv.py
```

The script:

- Detects today's date
- Loads `data/daily_summary_YYYY-MM-DD.json`
- Uploads to `articles/YYYY-MM-DD`
- Uses `--preview --remote` to ensure correct namespace

---

## Worker Logic (Simplified)

```typescript
export default {
  async fetch(request, env) {
    return handleRequest(request, env);
  }
};
```

The Worker:

1. Parses URL query (`?date=YYYY-MM-DD`)
2. Loads `articles/<date>` from KV
3. Parses JSON + groups by topic
4. Renders clean HTML (Bootstrap-ready)

---

## Requirements

- Node.js 18+
- Cloudflare account
- Wrangler 4.x+
- Python 3.10+ (for daily upload scripts)

---

## Security Notes

- `wrangler.toml` must not be committed
- All KV IDs in this repository are placeholders
- Real IDs should be stored only locally
- This repository follows Cloudflare's 2024â€“2025 security guidelines

---


# newslite-ui

UI layer for NewsLite, built on Cloudflare Workers + KV.

This project:
- reads daily NewsLite JSON from Workers KV
- renders HTML pages
- plays audio files hosted on R2


## Daily Operation

(upload mp3 manually)
â†“
python newslite_ui_daily_job.py        # preview
â†“
http://localhost:8787/?date=YYYY-MM-DD
â†“
python newslite_ui_daily_job.py --prod # production
â†“
https://newslite.tarclog.com/?date=YYYY-MM-DD



## License

MIT License.

Feel free to fork and adapt for your own Worker-based UI projects.